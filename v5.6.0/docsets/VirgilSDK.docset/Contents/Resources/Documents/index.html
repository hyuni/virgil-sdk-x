<!DOCTYPE html>
<html lang="en">
  <head>
    <title>VirgilSDK  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="VirgilSDK  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">VirgilSDK Docs</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">VirgilSDK Reference</a>
        <img id="carat" src="img/carat.png" />
        VirgilSDK  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AsyncOperation.html">AsyncOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AsyncOperation/State.html">– State</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/BaseClient.html">BaseClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CachingJwtProvider.html">CachingJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CallbackJwtProvider.html">CallbackJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CallbackOperation.html">CallbackOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Card.html">Card</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardClient.html">CardClient</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardManager.html">CardManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardManagerParams.html">CardManagerParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CardSignature.html">CardSignature</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ConstAccessTokenProvider.html">ConstAccessTokenProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GeneratorJwtProvider.html">GeneratorJwtProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GenericOperation.html">GenericOperation</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/GetCardResponse.html">GetCardResponse</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/HttpConnection.html">HttpConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Jwt.html">Jwt</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtBodyContent.html">JwtBodyContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtGenerator.html">JwtGenerator</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtHeaderContent.html">JwtHeaderContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtSignatureContent.html">JwtSignatureContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/JwtVerifier.html">JwtVerifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainEntry.html">KeychainEntry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorage.html">KeychainStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorageError.html">KeychainStorageError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/KeychainStorageParams.html">KeychainStorageParams</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ModelSigner.html">ModelSigner</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PrivateKeyEntry.html">PrivateKeyEntry</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PrivateKeyStorage.html">PrivateKeyStorage</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawCardContent.html">RawCardContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawServiceError.html">RawServiceError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawSignature.html">RawSignature</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RawSignedModel.html">RawSignedModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Request.html">Request</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Request/Method.html">– Method</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Response.html">Response</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ServiceError.html">ServiceError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ServiceRequest.html">ServiceRequest</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TokenContext.html">TokenContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/VerifierCredentials.html">VerifierCredentials</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/VirgilCardVerifier.html">VirgilCardVerifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Whitelist.html">Whitelist</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/BaseClientError.html">BaseClientError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CallbackOperationError.html">CallbackOperationError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CardClientError.html">CardClientError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/CardManagerError.html">CardManagerError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/DateUtils.html">DateUtils</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/GenericOperationError.html">GenericOperationError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtBodyContentError.html">JwtBodyContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtError.html">JwtError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtHeaderContentError.html">JwtHeaderContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/JwtSignatureContentError.html">JwtSignatureContentError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/KeychainStorageErrorCodes.html">KeychainStorageErrorCodes</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Log.html">Log</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/OperationUtils.html">OperationUtils</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RawSignedModelError.html">RawSignedModelError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RequestError.html">RequestError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Result.html">Result</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ServiceConnectionError.html">ServiceConnectionError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ServiceRequestError.html">ServiceRequestError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/WhitelistError.html">WhitelistError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Data.html">Data</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AccessToken.html">AccessToken</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/AccessTokenProvider.html">AccessTokenProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CardClientProtocol.html">CardClientProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/CardVerifier.html">CardVerifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/HttpConnectionProtocol.html">HttpConnectionProtocol</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='virgil-security-objective-c-swift-sdk' class='heading'>Virgil Security Objective-C/Swift SDK</h1>

<p><a href="https://travis-ci.com/VirgilSecurity/sdk-x"><img src="https://api.travis-ci.com/VirgilSecurity/sdk-x.svg?branch=master" alt="Build Status"></a>
<a href="https://cocoapods.org/pods/VirgilSDK"><img src="https://img.shields.io/cocoapods/v/VirgilSDK.svg" alt="CocoaPods Compatible"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a>
<a href="http://cocoadocs.org/docsets/VirgilSDK"><img src="https://img.shields.io/cocoapods/p/VirgilSDK.svg?style=flat" alt="Platform"></a>
<a href="https://github.com/VirgilSecurity/virgil/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-BSD%203--Clause-blue.svg" alt="GitHub license"></a></p>

<p><a href="#introduction">Introduction</a> | <a href="#sdk-features">SDK Features</a> | <a href="#installation">Installation</a> | <a href="#usage-examples">Usage Examples</a> | <a href="#docs">Docs</a> | <a href="#support">Support</a></p>
<h2 id='introduction' class='heading'>Introduction</h2>

<p><a href="https://developer.virgilsecurity.com/docs"><img width="230px" src="https://cdn.virgilsecurity.com/assets/images/github/logos/virgil-logo-red.png" align="left" hspace="10" vspace="6"></a> <a href="https://virgilsecurity.com">Virgil Security</a> provides a set of APIs for adding security to any application. In a few simple steps you can encrypt communication, securely store data, provide passwordless login, and ensure data integrity.</p>

<p>The Virgil SDK allows developers to get up and running with Virgil API quickly and add full end-to-end security to their existing digital solutions to become HIPAA and GDPR compliant and more.</p>
<h2 id='sdk-features' class='heading'>SDK Features</h2>

<ul>
<li>communicate with <a href="https://developer.virgilsecurity.com/docs/api-reference/card-service/v5">Virgil Cards Service</a></li>
<li>manage users&rsquo; Public Keys</li>
<li>store private keys in secure local storage</li>
<li>use Virgil <a href="https://github.com/VirgilSecurity/crypto-x">Crypto library</a></li>
<li>use your own Crypto</li>
</ul>
<h2 id='installation' class='heading'>Installation</h2>

<p>Virgil SDK is provided as a set of frameworks. These frameworks are distributed via Carthage and CocoaPods.  Also in this guide, you find one more package called VirgilCrypto (Virgil Crypto Library) that is used by the SDK to perform cryptographic operations.</p>

<p>All frameworks are available for:</p>

<ul>
<li>iOS 9.0+</li>
<li>macOS 10.10+</li>
<li>tvOS 9.0+</li>
<li>watchOS 2.0+</li>
</ul>
<h3 id='cocoapods' class='heading'>COCOAPODS</h3>

<p><a href="http://cocoapods.org">CocoaPods</a> is a dependency manager for Cocoa projects. You can install it with the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>gem install cocoapods
</code></pre>

<p>To integrate VirgilSDK into your Xcode project using CocoaPods, specify it in your <em>Podfile</em>:</p>
<pre class="highlight shell"><code>target <span class="s1">'&lt;Your Target Name&gt;'</span> <span class="k">do
  </span>use_frameworks!

  pod <span class="s1">'VirgilCryptoApiImpl'</span>, <span class="s1">'~&gt; 3.2'</span>
  pod <span class="s1">'VirgilSDK'</span>, <span class="s1">'~&gt; 5.6'</span>
end
</code></pre>

<p>Then, run the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pod install
</code></pre>
<h3 id='carthage' class='heading'>Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage">Carthage</a> is a decentralized dependency manager that builds your dependencies and provides you with binary frameworks.</p>

<p>You can install Carthage with <a href="http://brew.sh/">Homebrew</a> using the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>brew update
<span class="gp">$ </span>brew install carthage
</code></pre>

<p>To integrate VirgilSDK into your Xcode project using Carthage, create an empty file with name <em>Cartfile</em> in your project&rsquo;s root folder and add following lines to your <em>Cartfile</em></p>
<pre class="highlight plaintext"><code>github "VirgilSecurity/sdk-x" ~&gt; 5.6
github "VirgilSecurity/crypto-x" ~&gt; 3.2
</code></pre>
<h4 id='linking-against-prebuilt-binaries' class='heading'>Linking against prebuilt binaries</h4>

<p>To link prebuilt frameworks to your app, run following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>carthage update --no-use-binaries
</code></pre>

<p>This will build each dependency or download a pre-compiled framework from github Releases.</p>
<h5 id='building-for-ios-tvos-watchos' class='heading'>Building for iOS/tvOS/watchOS</h5>

<p>On your application targets’ “General” settings tab, in the “Linked Frameworks and Libraries” section, add following frameworks from the <em>Carthage/Build</em> folder inside your project&rsquo;s folder:</p>

<ul>
<li>VirgilSDK</li>
<li>VirgilCryptoAPI</li>
<li>VirgilCryptoApiImpl</li>
<li>VirgilCrypto</li>
<li>VSCCrypto</li>
</ul>

<p>On your application targets’ “Build Phases” settings tab, click the “+” icon and choose “New Run Script Phase.” Create a Run Script in which you specify your shell (ex: <em>/bin/sh</em>), add the following contents to the script area below the shell:</p>
<pre class="highlight shell"><code>/usr/local/bin/carthage copy-frameworks
</code></pre>

<p>and add the paths to the frameworks you want to use under “Input Files”, e.g.:</p>
<pre class="highlight plaintext"><code>$(SRCROOT)/Carthage/Build/iOS/VirgilSDK.framework
$(SRCROOT)/Carthage/Build/iOS/VirgilCryptoAPI.framework
$(SRCROOT)/Carthage/Build/iOS/VirgilCryptoAPIImpl.framework
$(SRCROOT)/Carthage/Build/iOS/VirgilCrypto.framework
$(SRCROOT)/Carthage/Build/iOS/VSCCrypto.framework
</code></pre>
<h5 id='building-for-macos' class='heading'>Building for macOS</h5>

<p>On your application target&rsquo;s “General” settings tab, in the “Embedded Binaries” section, drag and drop following frameworks from the Carthage/Build folder on disk:</p>

<ul>
<li>VirgilSDK</li>
<li>VirgilCryptoAPI</li>
<li>VirgilCryptoApiImpl</li>
<li>VirgilCrypto</li>
<li>VSCCrypto</li>
</ul>

<p>Additionally, you&rsquo;ll need to copy debug symbols for debugging and crash reporting on macOS.</p>

<p>On your application target’s “Build Phases” settings tab, click the “+” icon and choose “New Copy Files Phase”.
Click the “Destination” drop-down menu and select “Products Directory”. For each framework, drag and drop corresponding dSYM file.</p>
<h4 id='integrating-as-subproject' class='heading'>Integrating as subproject</h4>

<p>It is possible to use carthage just for fetching the right sources for further integration into your project.
Run following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>carthage update --no-build
</code></pre>

<p>This will fetch dependencies into a <em>Carthage/Checkouts</em> folder inside your project&rsquo;s folder. Then, drag and drop VirgilCrypto.xcodeproj, VirgilCryptoAPI.xcodeproj and VirgilSDK.xcodeproj from corresponding folders inside Carthage/Checkouts folder to your Xcode Project Navigator sidebar.</p>

<p>Next, on your application target&rsquo;s “General” settings tab, in the “Embedded Binaries” section add the following frameworks from subprojects:</p>

<ul>
<li>VirgilSDK</li>
<li>VirgilCryptoAPI</li>
<li>VirgilCryptoApiImpl</li>
<li>VirgilCrypto</li>
<li>VSCCrypto</li>
</ul>
<h2 id='usage-examples' class='heading'>Usage Examples</h2>

<p>Before starting practicing with the usage examples be sure that the SDK is configured. Check out our <a href="https://developer.virgilsecurity.com/docs/how-to#sdk-configuration">SDK configuration guides</a> for more information.</p>
<h4 id='generate-and-publish-user-39-s-cards-with-public-keys-inside-on-cards-service' class='heading'>Generate and publish user&rsquo;s Cards with Public Keys inside on Cards Service</h4>

<p>Use the following lines of code to create and publish a user&rsquo;s Card with Public Key inside on Virgil Cards Service:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCryptoApiImpl</span>

<span class="c1">// use Virgil Crypto</span>
<span class="k">let</span> <span class="nv">crypto</span> <span class="o">=</span> <span class="kt">VirgilCrypto</span><span class="p">()</span>

<span class="c1">// generate a user's key pair</span>
<span class="k">let</span> <span class="nv">keyPair</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">generateKeyPair</span><span class="p">()</span>

<span class="c1">// save a private key into key storage</span>
<span class="k">try!</span> <span class="n">privateKeyStorage</span><span class="o">.</span><span class="nf">store</span><span class="p">(</span><span class="nv">privateKey</span><span class="p">:</span> <span class="n">keyPair</span><span class="o">.</span><span class="n">privateKey</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Alice"</span><span class="p">,</span> <span class="nv">meta</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

<span class="c1">// publish user's card on the Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">publishCard</span><span class="p">(</span><span class="nv">privateKey</span><span class="p">:</span> <span class="n">keyPair</span><span class="o">.</span><span class="n">privateKey</span><span class="p">,</span> <span class="nv">publicKey</span><span class="p">:</span> <span class="n">keyPair</span><span class="o">.</span><span class="n">publicKey</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="c1">// Card is created</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">card</span><span class="p">):</span> <span class="k">break</span>
        <span class="c1">// Error occured</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='sign-then-encrypt-data' class='heading'>Sign then encrypt data</h4>

<p>Virgil SDK lets you use a user&rsquo;s Private key and his or her Cards to sign, then encrypt any kind of data.</p>

<p>In the following example, we load a Private Key from a customized Key Storage and get recipient&rsquo;s Card from the Virgil Cards Services. Recipient&rsquo;s Card contains a Public Key on which we will encrypt the data and verify a signature.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCryptoApiImpl</span>

<span class="c1">// prepare a message</span>
<span class="k">let</span> <span class="nv">messageToEncrypt</span> <span class="o">=</span> <span class="s">"Hello, Bob!"</span>
<span class="k">let</span> <span class="nv">dataToEncrypt</span> <span class="o">=</span> <span class="n">messageToEncrypt</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">!</span>

<span class="c1">// prepare a user's private key</span>
<span class="k">let</span> <span class="nv">alicePrivateKeyEntry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">privateKeyStorage</span><span class="o">.</span><span class="nf">load</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="s">"Alice"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">alicePrivateKey</span> <span class="o">=</span> <span class="n">alicePrivateKeyEntry</span><span class="o">.</span><span class="n">privateKey</span> <span class="k">as!</span> <span class="kt">VirgilPrivateKey</span>

<span class="c1">// using cardManager search for user's cards on Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">searchCards</span><span class="p">(</span><span class="nv">identity</span><span class="p">:</span> <span class="s">"Bob"</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Cards are obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">cards</span><span class="p">):</span>
        <span class="k">let</span> <span class="nv">bobRelevantCardsPublicKeys</span> <span class="o">=</span> <span class="n">cards</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">publicKey</span> <span class="p">}</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">VirgilPublicKey</span><span class="p">]</span>

        <span class="c1">// sign a message with a private key then encrypt on a public key</span>
        <span class="k">let</span> <span class="nv">encryptedData</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">signThenEncrypt</span><span class="p">(</span><span class="n">dataToEncrypt</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="n">alicePrivateKey</span><span class="p">,</span>
                                                        <span class="nv">for</span><span class="p">:</span> <span class="n">bobRelevantCardsPublicKeys</span><span class="p">)</span>

    <span class="c1">// Error occured</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='decrypt-then-verify-data' class='heading'>Decrypt then verify data</h4>

<p>Once the Users receive the signed and encrypted message, they can decrypt it with their own Private Key and verify signature with a Sender&rsquo;s Card:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">VirgilSDK</span>
<span class="kd">import</span> <span class="kt">VirgilCryptoApiImpl</span>

<span class="c1">// prepare a user's private key</span>
<span class="k">let</span> <span class="nv">bobPrivateKeyEntry</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">privateKeyStorage</span><span class="o">.</span><span class="nf">load</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="s">"Bob"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">bobPrivateKey</span> <span class="o">=</span> <span class="n">bobPrivateKeyEntry</span><span class="o">.</span><span class="n">privateKey</span> <span class="k">as!</span> <span class="kt">VirgilPrivateKey</span>

<span class="c1">// using cardManager search for user's cards on Cards Service</span>
<span class="n">cardManager</span><span class="o">.</span><span class="nf">searchCards</span><span class="p">(</span><span class="nv">identity</span><span class="p">:</span> <span class="s">"Alice"</span><span class="p">)</span><span class="o">.</span><span class="n">start</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="c1">// Cards are obtained</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">cards</span><span class="p">):</span>
        <span class="k">let</span> <span class="nv">aliceRelevantCardsPublicKeys</span> <span class="o">=</span> <span class="n">cards</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">publicKey</span> <span class="p">}</span> <span class="k">as!</span> <span class="p">[</span><span class="kt">VirgilPublicKey</span><span class="p">]</span>

        <span class="c1">// decrypt with a private key and verify using a public key</span>
        <span class="k">let</span> <span class="nv">decryptedData</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">crypto</span><span class="o">.</span><span class="nf">decryptThenVerify</span><span class="p">(</span><span class="n">encryptedData</span><span class="p">,</span> <span class="nv">with</span><span class="p">:</span> <span class="n">bobPrivateKey</span><span class="p">,</span>
                                                          <span class="nv">usingOneOf</span><span class="p">:</span> <span class="n">aliceRelevantCardsPublicKeys</span><span class="p">)</span>

    <span class="c1">// Error occured</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span> <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='docs' class='heading'>Docs</h2>

<p>Virgil Security has a powerful set of APIs, and the documentation below can get you started today.</p>

<p>In order to use the Virgil SDK with your application, you will need to first configure your application. By default, the SDK will attempt to look for Virgil-specific settings in your application but you can change it during SDK configuration.</p>

<ul>
<li><a href="https://developer.virgilsecurity.com/docs/how-to#sdk-configuration">Configure the SDK</a> documentation

<ul>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/setup/v5/setup-authentication">Setup authentication</a> to make API calls to Virgil Services</li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/setup/v5/setup-card-manager">Setup Card Manager</a> to manage user&rsquo;s Public Keys</li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/setup/v5/setup-card-verifier">Setup Card Verifier</a> to verify signatures inside of user&rsquo;s Card</li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/setup/v5/setup-key-storage">Setup Key storage</a> to store Private Keys</li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/setup/v5/setup-own-crypto-library">Setup your own Crypto library</a> inside of the SDK</li>
</ul></li>
<li><a href="https://developer.virgilsecurity.com/docs/how-to#public-key-management">More usage examples</a>

<ul>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/public-key-management/v5/create-card">Create &amp; publish a Card</a> that has a Public Key on Virgil Cards Service</li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/public-key-management/v5/search-card">Search user&rsquo;s Card by user&rsquo;s identity</a></li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/public-key-management/v5/get-card">Get user&rsquo;s Card by its ID</a></li>
<li><a href="https://developer.virgilsecurity.com/docs/swift/how-to/public-key-management/v5/use-card-for-crypto-operation">Use Card for crypto operations</a></li>
</ul></li>
<li><a href="https://developer.virgilsecurity.com/docs/api-reference">Reference API</a></li>
</ul>
<h2 id='license' class='heading'>License</h2>

<p>This library is released under the <a href="LICENSE">3-clause BSD License</a>.</p>
<h2 id='support' class='heading'>Support</h2>

<p>Our developer support team is here to help you. Find out more information on our <a href="https://help.virgilsecurity.com/">Help Center</a>.</p>

<p>You can find us on <a href="https://twitter.com/VirgilSecurity">Twitter</a> or send us email <a href="mailto:support@VirgilSecurity.com">support@VirgilSecurity.com</a>.</p>

<p>Also, get extra help from our support team on <a href="https://virgilsecurity.slack.com/join/shared_invite/enQtMjg4MDE4ODM3ODA4LTc2OWQwOTQ3YjNhNTQ0ZjJiZDc2NjkzYjYxNTI0YzhmNTY2ZDliMGJjYWQ5YmZiOGU5ZWEzNmJiMWZhYWVmYTM">Slack</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2018 <a class="link" href="https://virgilsecurity.com/" target="_blank" rel="external">Virgil Security</a>. All rights reserved. (Last updated: 2018-12-07)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
